
jQuery(document).ready(function($){var header_id=document.getElementById('header-menu');var footer_id=document.getElementById('footer-menu');if(header_id.id==="header-menu"){$('#hamburger').on('click',function(){$(`#${header_id.id}`).toggleClass('active')})}
if(footer_id.id==="footer-menu"){if(footer_id){footer_id.classList.remove("custom-menu")
footer_id.style.display="flex"
footer_id.style.flexWrap="wrap"
footer_id.style.justifyContent="space-around"
footer_id.style.alignItems="center"
footer_id.style.listStyle="none"
footer_id.style.margin='0px'
footer_id.style.padding="0px"}}});



const fileInput=document.getElementById("imagem_ocorrido");const uploadArea=document.getElementById("upload-area");const previewContainer=document.getElementById("preview-container");let selectedFiles=[];uploadArea.addEventListener("click",()=>fileInput.click());uploadArea.addEventListener("dragover",(event)=>{event.preventDefault();uploadArea.style.background="#e9ecef"});uploadArea.addEventListener("dragleave",()=>{uploadArea.style.background=""});uploadArea.addEventListener("drop",(event)=>{event.preventDefault();uploadArea.style.background="";handleFiles(event.dataTransfer.files)});fileInput.addEventListener("change",(event)=>handleFiles(event.target.files));function handleFiles(files){if(selectedFiles.length+files.length>3){alert("Você pode adicionar no máximo 3 imagens.");return}
const allowedTypes=["image/jpeg","image/png","image/gif"];for(let file of files){if(selectedFiles.length>=3)break;if(file.size>2*1024*1024){alert(`"${file.name}" excede o limite de 2MB.`);continue}
if(!allowedTypes.includes(file.type)){alert(`"${file.name}" não é um formato permitido.`);continue}
selectedFiles.push(file);displayPreview(file)}}
function displayPreview(file){const reader=new FileReader();reader.onload=function(e){const previewBox=document.createElement("div");previewBox.classList.add("preview-box");const img=document.createElement("img");img.src=e.target.result;const removeBtn=document.createElement("button");removeBtn.classList.add("remove-btn");removeBtn.innerHTML="✖";removeBtn.onclick=()=>removeImage(file,previewBox);previewBox.appendChild(img);previewBox.appendChild(removeBtn);previewContainer.appendChild(previewBox)};reader.readAsDataURL(file)}
function removeImage(file,previewBox){selectedFiles=selectedFiles.filter((f)=>f!==file);previewBox.remove()}
const form=document.getElementById("form-relatorio");form.addEventListener("submit",function(e){e.preventDefault();const formData=new FormData(form);selectedFiles.forEach((file)=>{formData.append("imagem_ocorrido[]",file)});fetch(form.action||window.location.href,{method:"POST",body:formData,}).then((res)=>{if(res.redirected){window.location.href=res.url}else{return res.text()}}).then((data)=>{if(typeof data==="string")console.log(data);}).catch((err)=>{console.error("Erro no envio:",err);alert("Erro ao enviar. Verifique sua conexão e tente novamente.")})});


